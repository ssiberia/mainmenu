import ipaddress
from dataclasses import field
from typing import Optional

from dataclasses_json import config, dataclass_json
from pydantic.dataclasses import dataclass

from anx_pyengine.models.public_prefix import PublicPrefix
from anx_pyengine.models.public_vlan import PublicVLAN

from .util import PydanticConfig, ipaddr_to_json_encoder


@dataclass_json
@dataclass(config=PydanticConfig)
class PublicAddress:
    address: ipaddress._BaseAddress = field(
        metadata=config(encoder=ipaddr_to_json_encoder, decoder=ipaddress.ip_address)
    )

    identifier: str
    description_customer: str
    description_internal: str
    version: int
    role: str
    status: str
    prefix: PublicPrefix
    vlan: Optional[PublicVLAN] = None
